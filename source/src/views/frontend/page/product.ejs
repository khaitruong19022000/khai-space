<%
	const folderUpload = 'uploads/products/'
	const linkPrefix   = '/product'
%>

<% include ./../helper/price.ejs %>
<% include ./../helper/highlight-char.ejs %>
<% include ./../helper/check-box-ajax.ejs %>
<% include ./../helper/add_cart.ejs %>
<% include ./../helper/pagination.ejs %>


		<!-- Content
		============================================= -->
		<section id="content">
			<div class="content-wrap">

				<div class="container">

					<div class="row justify-content-between align-items-center">
						<div class="col-auto mb-4">
							<h3 class="fw-medium h1">All <span data-animate="svg-underline-animated" class="svg-underline nocolor"><span>Products</span></span></h3>
						</div>
					</div>

					<!-- Shop
					============================================= -->
					<div id="shop" class="shop row gutter-30 col-mb-30 mt-3">
						<% product.forEach((value) => { %>
						<div class="product col-lg-3 col-md-4 col-sm-6 col-12">
							<div class="grid-inner">
								<div class="product-image">
									<a href="/view_product/<%= value.id%>"><img src="<%= folderUpload%><%= value.avatar[0]%>" alt=""></a>
									<a href="/view_product/<%= value.id%>"><img src="<%= folderUpload%><%= value.avatar[1]%>" alt=""></a>
									<div class="bg-overlay">
										<div class="bg-overlay-content align-items-end justify-content-between" data-hover-animate="fadeIn" data-hover-speed="400">
											<%- addCartHelper(value.id, value.name, value.avatar[0], value.price)%>
											<a href="/view_product/<%= value.id%>" class="btn btn-light"><i class="icon-line-expand"></i></a>
										</div>
									</div>
								</div>
								<div class="product-desc">
									<div class="product-title mb-0"><h4 class="mb-0"><a class="fw-medium" href="/view_product/<%= value.id%>"><%- highlightHelper(value.name, search) %></a></h4></div>
									<h5 class="product-price fw-normal"><%- priceHelper(value.price)%></h5>
								</div>
							</div>
						</div>
						<% }) %>
					</div>
					<!-- #shop end -->
					<div class="clear"></div>

					<nav aria-label="Page navigation">
						<%- paginationHelper(pagination, slug, search, linkPrefix) %>
					</nav>

				</div>

			</div>
		</section>
		<!-- #content end -->

		<!-- <script>
			//---show List category product ---//
			function showList() {
				document.getElementById("showList").classList.toggle("show");
			}
			const priceHelper = (price) => {
				let USDollar = new Intl.NumberFormat('vi-VN', {
					style: 'currency',
					currency: 'VND',
				});
				let newprice = USDollar.format(price)

				return newprice;
			}
			const addCartHelper = (id, name, avatar, price) => {
				xhtmlStatus = `<a class="btn btn-light me-2"><i onclick="addCart('${id}', '${name}', '${avatar}', '${price}')" class="icon-line-shopping-cart"></i></a>`
				return xhtmlStatus;
			}
			const highlightHelper = (name, keyword) => {
				if(keyword !== ""){
					const regex = new RegExp(keyword, "gi");
					name = name.replace(regex, (search) => {
						return `<span class="text-red">${search}</span>`
					});
					return name;
				}
				return name;
			}
			const showProducts = (product, search) => {
				const folderUpload = 'uploads/products/'
				let shop = document.getElementById('shop')
				shop.innerHTML = ''
				product.forEach(value => {
					let addCart = addCartHelper(value.id, value.name ,value.avatar[0], value.price)
					let highlight = highlightHelper(value.name, search)
					let price = priceHelper(value.price)
					shop.innerHTML += `<div class="product col-lg-3 col-md-4 col-sm-6 col-12">
								<div class="grid-inner">
									<div class="product-image">
										<a href="/view_product/${value.id}"><img src="${folderUpload}${value.avatar[0]}" alt=""></a>
										<a href="/view_product/${value.id}"><img src="${folderUpload}${value.avatar[1]}" alt=""></a>
										<div class="bg-overlay">
											<div class="bg-overlay-content align-items-end justify-content-between" data-hover-animate="fadeIn" data-hover-speed="400">
												${addCart}
												<a href="/view_product/${value.id}" class="btn btn-light"><i class="icon-line-expand"></i></a>
											</div>
										</div>
									</div>
									<div class="product-desc">
										<div class="product-title mb-0"><h4 class="mb-0"><a class="fw-medium" href="/view_product/${value.id}">${highlight}</a></h4></div>
										<h5 class="product-price fw-normal">${price}</h5>
									</div>
								</div>
							</div>`
				})
			}


			const product = JSON.parse('<%-JSON.stringify(product)%>')
			const search = JSON.parse('<%-JSON.stringify(search)%>')
			showProducts(product, search)

		</script> -->
